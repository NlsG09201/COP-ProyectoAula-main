import{a as W}from"./chunk-UG73MJDQ.js";import{$a as p,Ea as S,Gb as x,Ha as _,Hb as M,Ib as v,Nb as I,Oa as h,Pa as e,Qa as t,Ta as C,Ua as b,_a as n,cb as c,db as f,eb as u,pa as a,wb as E,xb as P,yb as w,za as y}from"./chunk-NP5DNCOA.js";function T(l,d){if(l&1&&(e(0,"div",11),n(1),t()),l&2){let m=b();a(),p(m.msg)}}function D(l,d){if(l&1&&(e(0,"tr",16)(1,"td",17),n(2),t(),e(3,"td",17),n(4),t(),e(5,"td",17),n(6),t(),e(7,"td",17),n(8),t(),e(9,"td",17),n(10),t(),e(11,"td",17),n(12),t()()),l&2){let m=d.$implicit;a(2),p(m.idP||m.idPersona),a(2),p(m.docIden),a(2),p(m.nombreCompleto),a(2),p(m.telefono),a(2),p(m.email),a(2),p(m.direccion)}}function F(l,d){if(l&1&&(e(0,"table",12)(1,"thead",13)(2,"tr")(3,"th",14),n(4,"ID"),t(),e(5,"th",14),n(6,"Documento"),t(),e(7,"th",14),n(8,"Nombre"),t(),e(9,"th",14),n(10,"Tel\xE9fono"),t(),e(11,"th",14),n(12,"Email"),t(),e(13,"th",14),n(14,"Direcci\xF3n"),t()()(),e(15,"tbody"),_(16,D,13,6,"tr",15),t()()),l&2){let m=b();a(16),h("ngForOf",m.filtrados)}}function L(l,d){l&1&&(e(0,"div",11),n(1,"No hay pacientes registrados."),t())}var G=(()=>{let d=class d{constructor(r){this.api=r,this.form={docIden:"",nombreCompleto:""},this.msg="",this.loading=!1,this.pacientes=[],this.filtrados=[],this.filtro="",this.cargar()}guardar(){if(!this.form.docIden||!this.form.nombreCompleto){this.msg="Documento y Nombre son obligatorios.";return}this.loading=!0,this.msg="",this.api.post("/pacientes",this.form).subscribe({next:r=>{this.msg="Paciente registrado (ID "+(r.idP||r.idPersona||"N/A")+")",this.loading=!1,this.cargar()},error:r=>{let s=typeof r?.error=="string"?r.error:JSON.stringify(r?.error||{});s&&s.toLowerCase().includes("documento de identidad ya registrado")?this.msg="Documento de identidad ya registrado":this.msg="Error registrando paciente",this.loading=!1}})}cargar(){this.loading=!0,this.api.get("/pacientes").subscribe({next:r=>{this.pacientes=r,this.aplicarFiltro(),this.loading=!1},error:()=>{this.msg="Error cargando pacientes",this.loading=!1}})}aplicarFiltro(){let r=(this.filtro||"").toLowerCase();this.filtrados=this.pacientes.filter(s=>(s.docIden||"").toLowerCase().includes(r)||(s.nombreCompleto||"").toLowerCase().includes(r))}};d.\u0275fac=function(s){return new(s||d)(y(W))},d.\u0275cmp=S({type:d,selectors:[["app-pacientes-page"]],decls:37,vars:10,consts:[[1,"text-2xl","font-semibold","mb-2"],[1,"text-slate-600","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],[1,"field"],[3,"ngModelChange","ngModel"],[1,"btn",3,"click","disabled"],["class","mt-2",4,"ngIf"],[1,"text-xl","font-semibold","mt-8","mb-2"],["placeholder","Nombre/Documento",3,"ngModelChange","ngModel"],[1,"overflow-x-auto","rounded-lg","shadow"],["class","min-w-full bg-white",4,"ngIf"],[1,"mt-2"],[1,"min-w-full","bg-white"],[1,"bg-blue-50"],[1,"px-4","py-2","text-left"],["class","border-t",4,"ngFor","ngForOf"],[1,"border-t"],[1,"px-4","py-2"]],template:function(s,i){s&1&&(e(0,"h2",0),n(1,"Pacientes"),t(),e(2,"p",1),n(3,"Registra y administra pacientes."),t(),e(4,"div",2)(5,"div",3)(6,"label"),n(7,"Documento"),t(),e(8,"input",4),u("ngModelChange",function(o){return f(i.form.docIden,o)||(i.form.docIden=o),o}),t()(),e(9,"div",3)(10,"label"),n(11,"Nombre"),t(),e(12,"input",4),u("ngModelChange",function(o){return f(i.form.nombreCompleto,o)||(i.form.nombreCompleto=o),o}),t()(),e(13,"div",3)(14,"label"),n(15,"Tel\xE9fono"),t(),e(16,"input",4),u("ngModelChange",function(o){return f(i.form.telefono,o)||(i.form.telefono=o),o}),t()(),e(17,"div",3)(18,"label"),n(19,"Email"),t(),e(20,"input",4),u("ngModelChange",function(o){return f(i.form.email,o)||(i.form.email=o),o}),t()(),e(21,"div",3)(22,"label"),n(23,"Direcci\xF3n"),t(),e(24,"input",4),u("ngModelChange",function(o){return f(i.form.direccion,o)||(i.form.direccion=o),o}),t()()(),e(25,"button",5),C("click",function(){return i.guardar()}),n(26,"Guardar"),t(),_(27,T,2,1,"div",6),e(28,"h3",7),n(29,"Lista de pacientes"),t(),e(30,"div",3)(31,"label"),n(32,"Buscar"),t(),e(33,"input",8),u("ngModelChange",function(o){return f(i.filtro,o)||(i.filtro=o),o}),C("ngModelChange",function(){return i.aplicarFiltro()}),t()(),e(34,"div",9),_(35,F,17,1,"table",10),t(),_(36,L,2,0,"div",6)),s&2&&(a(8),c("ngModel",i.form.docIden),a(4),c("ngModel",i.form.nombreCompleto),a(4),c("ngModel",i.form.telefono),a(4),c("ngModel",i.form.email),a(4),c("ngModel",i.form.direccion),a(),h("disabled",i.loading),a(2),h("ngIf",i.msg),a(6),c("ngModel",i.filtro),a(2),h("ngIf",i.filtrados.length),a(),h("ngIf",!i.filtrados.length&&!i.loading))},dependencies:[w,E,P,I,x,M,v],encapsulation:2});let l=d;return l})();export{G as PacientesPageComponent};
